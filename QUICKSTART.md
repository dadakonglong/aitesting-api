# å¿«é€Ÿæµ‹è¯•æŒ‡å—

## ğŸš€ 5åˆ†é’Ÿå¿«é€Ÿå¼€å§‹

### æ­¥éª¤1: é…ç½®ç¯å¢ƒå˜é‡ï¼ˆ1åˆ†é’Ÿï¼‰

```bash
# 1. å¤åˆ¶ç¯å¢ƒå˜é‡æ¨¡æ¿
cp .env.example .env

# 2. ç¼–è¾‘.envæ–‡ä»¶ï¼Œè®¾ç½®OPENAI_API_KEY
# Windows: ä½¿ç”¨è®°äº‹æœ¬æ‰“å¼€
notepad .env

# Linux/Mac: ä½¿ç”¨vimæˆ–nano
vim .env
```

åœ¨`.env`æ–‡ä»¶ä¸­æ‰¾åˆ°è¿™ä¸€è¡Œå¹¶å¡«å…¥ä½ çš„API Keyï¼š
```
OPENAI_API_KEY=your_openai_api_key_here
```

### æ­¥éª¤2: å¯åŠ¨æœåŠ¡ï¼ˆ2åˆ†é’Ÿï¼‰

```bash
# Windowsç”¨æˆ·
.\scripts\start.bat

# Linux/Macç”¨æˆ·
chmod +x ./scripts/start.sh
./scripts/start.sh
```

**ç­‰å¾…æœåŠ¡å¯åŠ¨å®Œæˆ**ï¼ˆå¤§çº¦30-60ç§’ï¼‰ï¼Œä½ ä¼šçœ‹åˆ°ï¼š
```
âœ… æœåŠ¡å¯åŠ¨å®Œæˆï¼

ğŸ“Š æœåŠ¡è®¿é—®åœ°å€ï¼š
  - AIæœåŠ¡APIæ–‡æ¡£: http://localhost:8000/docs
  - Neo4jæµè§ˆå™¨: http://localhost:7474
  - RabbitMQç®¡ç†: http://localhost:15672
```

### æ­¥éª¤3: è¿è¡Œç«¯åˆ°ç«¯æµ‹è¯•ï¼ˆ2åˆ†é’Ÿï¼‰

```bash
# 1. å®‰è£…æµ‹è¯•ä¾èµ–
pip install httpx

# 2. è¿è¡Œæµ‹è¯•
python scripts/test_e2e.py
```

**æµ‹è¯•ä¼šè‡ªåŠ¨æ‰§è¡Œä»¥ä¸‹æ“ä½œï¼š**
1. å¯¼å…¥Petstore APIçš„æ¥å£å®šä¹‰
2. åˆ›å»ºæµ‹è¯•åœºæ™¯ï¼š"æµ‹è¯•æŸ¥è¯¢å® ç‰©ä¿¡æ¯"
3. ç”Ÿæˆæµ‹è¯•ç”¨ä¾‹ï¼ˆåŒ…å«æ•°æ®å’Œæ–­è¨€ï¼‰
4. æ‰§è¡Œæµ‹è¯•å¹¶å±•ç¤ºç»“æœ

## ğŸ“‹ è¯¦ç»†æµ‹è¯•æ­¥éª¤

### æ–¹å¼1: è‡ªåŠ¨åŒ–æµ‹è¯•ï¼ˆæ¨èï¼‰

ä½¿ç”¨ç«¯åˆ°ç«¯æµ‹è¯•è„šæœ¬ï¼š

```bash
python scripts/test_e2e.py
```

**é¢„æœŸè¾“å‡ºï¼š**
```
ğŸš€ğŸš€ğŸš€ AIæ™ºèƒ½æ¥å£æµ‹è¯•å¹³å° - ç«¯åˆ°ç«¯æµ‹è¯• ğŸš€ğŸš€ğŸš€

ğŸ” æ£€æŸ¥æœåŠ¡çŠ¶æ€...
âœ… AIæœåŠ¡ å°±ç»ª
âœ… åœºæ™¯ç¼–æ’æœåŠ¡ å°±ç»ª
âœ… æµ‹è¯•æ‰§è¡ŒæœåŠ¡ å°±ç»ª

============================================================
æ­¥éª¤1: å¯¼å…¥Swaggeræ–‡æ¡£
============================================================
âœ… å¯¼å…¥æˆåŠŸ: 20 ä¸ªæ¥å£
   é¡¹ç›®ID: e2e-test-project

============================================================
æ­¥éª¤2: åˆ›å»ºæµ‹è¯•åœºæ™¯
============================================================
ğŸ“ åœºæ™¯æè¿°: æµ‹è¯•æŸ¥è¯¢å® ç‰©ä¿¡æ¯
âœ… åœºæ™¯åˆ›å»ºæˆåŠŸ
   åœºæ™¯ID: xxx-xxx-xxx
   åœºæ™¯åç§°: æŸ¥è¯¢å® ç‰©ä¿¡æ¯
   
   ğŸ“‹ è§£æå‡º 2 ä¸ªæµ‹è¯•æ­¥éª¤:
      1. GET /pet/{petId}
         æ ¹æ®IDæŸ¥è¯¢å® ç‰©ä¿¡æ¯

============================================================
æ­¥éª¤3: ç”Ÿæˆæµ‹è¯•ç”¨ä¾‹
============================================================
âœ… æµ‹è¯•ç”¨ä¾‹ç”ŸæˆæˆåŠŸ
   ç”¨ä¾‹ID: xxx-xxx-xxx
   æ­¥éª¤æ•°: 2

============================================================
æ­¥éª¤4: æ‰§è¡Œæµ‹è¯•
============================================================
âœ… æµ‹è¯•å·²æäº¤æ‰§è¡Œ
â³ ç­‰å¾…æ‰§è¡Œå®Œæˆ...
âœ… æ‰§è¡Œå®Œæˆ

============================================================
æ­¥éª¤5: æµ‹è¯•ç»“æœ
============================================================
ğŸ“Š æ‰§è¡Œæ‘˜è¦:
   çŠ¶æ€: âœ… æˆåŠŸ
   æ€»æ­¥éª¤æ•°: 2
   æˆåŠŸæ­¥éª¤: 2
   æ€»æ–­è¨€æ•°: 5
   é€šè¿‡æ–­è¨€: 5
   æˆåŠŸç‡: 100.00%

============================================================
âœ… ç«¯åˆ°ç«¯æµ‹è¯•å®Œæˆï¼
============================================================
```

### æ–¹å¼2: æ‰‹åŠ¨APIæµ‹è¯•

#### 2.1 è®¿é—®APIæ–‡æ¡£

æ‰“å¼€æµè§ˆå™¨è®¿é—®ï¼šhttp://localhost:8000/docs

ä½ ä¼šçœ‹åˆ°Swagger UIç•Œé¢ï¼Œå¯ä»¥äº¤äº’å¼æµ‹è¯•æ‰€æœ‰APIã€‚

#### 2.2 æ‰‹åŠ¨æµ‹è¯•æµç¨‹

**æ­¥éª¤1: å¯¼å…¥Swaggeræ–‡æ¡£**

```bash
curl -X POST "http://localhost:8000/api/v1/import/swagger" \
  -H "Content-Type: application/json" \
  -d "{\"source_type\":\"swagger\",\"source\":\"https://petstore.swagger.io/v2/swagger.json\",\"project_id\":\"my-project\"}"
```

**æ­¥éª¤2: åˆ›å»ºæµ‹è¯•åœºæ™¯**

```bash
curl -X POST "http://localhost:8081/api/v1/scenarios" \
  -H "Content-Type: application/json" \
  -d "{\"project_id\":\"my-project\",\"natural_language_input\":\"æµ‹è¯•æŸ¥è¯¢å® ç‰©ä¿¡æ¯\"}"
```

ä¿å­˜è¿”å›çš„`scenario_id`ã€‚

**æ­¥éª¤3: ç”Ÿæˆæµ‹è¯•ç”¨ä¾‹**

```bash
curl -X POST "http://localhost:8081/api/v1/scenarios/{scenario_id}/generate-case" \
  -H "Content-Type: application/json" \
  -d "{\"data_strategy\":\"smart\"}"
```

ä¿å­˜è¿”å›çš„`test_case_id`ã€‚

**æ­¥éª¤4: æ‰§è¡Œæµ‹è¯•**

```bash
curl -X POST "http://localhost:8083/api/v1/executions" \
  -H "Content-Type: application/json" \
  -d "{\"test_case_id\":\"{test_case_id}\",\"environment\":\"test\",\"base_url\":\"https://petstore.swagger.io/v2\"}"
```

ä¿å­˜è¿”å›çš„`execution_id`ã€‚

**æ­¥éª¤5: æŸ¥çœ‹ç»“æœ**

```bash
curl "http://localhost:8083/api/v1/executions/{execution_id}"
```

## ğŸ” éªŒè¯æœåŠ¡çŠ¶æ€

### æ£€æŸ¥æ‰€æœ‰æœåŠ¡æ˜¯å¦è¿è¡Œ

```bash
docker-compose ps
```

ä½ åº”è¯¥çœ‹åˆ°ä»¥ä¸‹æœåŠ¡éƒ½åœ¨è¿è¡Œï¼š
- aitesting-postgres
- aitesting-neo4j
- aitesting-qdrant
- aitesting-redis
- aitesting-rabbitmq
- aitesting-ai-service
- aitesting-scenario-service
- aitesting-execution-service

### æ£€æŸ¥æœåŠ¡å¥åº·çŠ¶æ€

```bash
# AIæœåŠ¡
curl http://localhost:8000/health

# åœºæ™¯ç¼–æ’æœåŠ¡
curl http://localhost:8081/health

# æµ‹è¯•æ‰§è¡ŒæœåŠ¡
curl http://localhost:8083/health
```

éƒ½åº”è¯¥è¿”å›ï¼š`{"status":"healthy"}`

## ğŸ“Š æŸ¥çœ‹æœåŠ¡æ—¥å¿—

```bash
# æŸ¥çœ‹æ‰€æœ‰æœåŠ¡æ—¥å¿—
docker-compose logs -f

# æŸ¥çœ‹ç‰¹å®šæœåŠ¡æ—¥å¿—
docker-compose logs -f ai-service
docker-compose logs -f scenario-service
docker-compose logs -f execution-service
```

## âŒ æ•…éšœæ’æŸ¥

### é—®é¢˜1: æœåŠ¡å¯åŠ¨å¤±è´¥

**ç—‡çŠ¶ï¼š** `docker-compose ps`æ˜¾ç¤ºæœåŠ¡çŠ¶æ€ä¸ºExit

**è§£å†³æ–¹æ³•ï¼š**
```bash
# æŸ¥çœ‹é”™è¯¯æ—¥å¿—
docker-compose logs ai-service

# å¸¸è§åŸå› ï¼š
# 1. OPENAI_API_KEYæœªé…ç½® â†’ æ£€æŸ¥.envæ–‡ä»¶
# 2. ç«¯å£è¢«å ç”¨ â†’ ä¿®æ”¹.envä¸­çš„ç«¯å£é…ç½®
# 3. å†…å­˜ä¸è¶³ â†’ å¢åŠ Dockerå†…å­˜é™åˆ¶
```

### é—®é¢˜2: OpenAI APIé”™è¯¯

**ç—‡çŠ¶ï¼š** æµ‹è¯•æ—¶æŠ¥é”™"OpenAI API error"

**è§£å†³æ–¹æ³•ï¼š**
1. æ£€æŸ¥`.env`æ–‡ä»¶ä¸­çš„`OPENAI_API_KEY`æ˜¯å¦æ­£ç¡®
2. ç¡®è®¤API Keyæœ‰æ•ˆä¸”æœ‰ä½™é¢
3. æ£€æŸ¥ç½‘ç»œè¿æ¥
4. å¦‚æœåœ¨å›½å†…ï¼Œå¯èƒ½éœ€è¦é…ç½®ä»£ç†

### é—®é¢˜3: å‘é‡æœç´¢æ— ç»“æœ

**ç—‡çŠ¶ï¼š** åˆ›å»ºåœºæ™¯æ—¶æ‰¾ä¸åˆ°ç›¸å…³æ¥å£

**è§£å†³æ–¹æ³•ï¼š**
1. ç¡®ä¿å·²æˆåŠŸå¯¼å…¥æ¥å£æ•°æ®
2. ç­‰å¾…3-5ç§’è®©å‘é‡ç´¢å¼•å®Œæˆ
3. æ£€æŸ¥QdrantæœåŠ¡æ˜¯å¦æ­£å¸¸ï¼š`curl http://localhost:6333/health`

### é—®é¢˜4: æµ‹è¯•æ‰§è¡Œå¤±è´¥

**ç—‡çŠ¶ï¼š** æ‰§è¡ŒçŠ¶æ€ä¸º"failed"

**è§£å†³æ–¹æ³•ï¼š**
1. æ£€æŸ¥ç›®æ ‡APIæ˜¯å¦å¯è®¿é—®
2. éªŒè¯base_urlæ˜¯å¦æ­£ç¡®
3. æŸ¥çœ‹æ‰§è¡Œç»“æœä¸­çš„error_msg
4. æ£€æŸ¥ç½‘ç»œè¿æ¥

## ğŸ›‘ åœæ­¢æœåŠ¡

```bash
# åœæ­¢æ‰€æœ‰æœåŠ¡
docker-compose down

# åœæ­¢å¹¶åˆ é™¤æ•°æ®å·ï¼ˆæ¸…ç©ºæ‰€æœ‰æ•°æ®ï¼‰
docker-compose down -v
```

## ğŸ”„ é‡å¯æœåŠ¡

```bash
# é‡å¯æ‰€æœ‰æœåŠ¡
docker-compose restart

# é‡å¯ç‰¹å®šæœåŠ¡
docker-compose restart ai-service
```

## ğŸ’¡ æµ‹è¯•æŠ€å·§

### 1. æµ‹è¯•ä¸åŒçš„åœºæ™¯

ä¿®æ”¹`scripts/test_e2e.py`ä¸­çš„åœºæ™¯æè¿°ï¼š

```python
scenarios = [
    "æµ‹è¯•æŸ¥è¯¢å® ç‰©ä¿¡æ¯",
    "æµ‹è¯•æ·»åŠ æ–°å® ç‰©åæŸ¥è¯¢",
    "æµ‹è¯•æ›´æ–°å® ç‰©çŠ¶æ€",
    "æµ‹è¯•åˆ é™¤å® ç‰©",
    # æ·»åŠ ä½ è‡ªå·±çš„åœºæ™¯
]
```

### 2. ä½¿ç”¨è‡ªå·±çš„Swaggeræ–‡æ¡£

```bash
curl -X POST "http://localhost:8000/api/v1/import/swagger" \
  -H "Content-Type: application/json" \
  -d "{\"source_type\":\"swagger\",\"source\":\"ä½ çš„Swagger URL\",\"project_id\":\"your-project\"}"
```

### 3. å¯¼å…¥Postman Collection

```bash
curl -X POST "http://localhost:8000/api/v1/import/postman" \
  -F "file=@your-collection.json" \
  -F "project_id=your-project"
```

## ğŸ“š ä¸‹ä¸€æ­¥

æµ‹è¯•æˆåŠŸåï¼Œä½ å¯ä»¥ï¼š

1. **å¼€å‘å‰ç«¯ç•Œé¢** - æä¾›æ›´å‹å¥½çš„ç”¨æˆ·äº¤äº’
2. **æ·»åŠ æ›´å¤šæ•°æ®æº** - æ”¯æŒæ›´å¤šæ ¼å¼çš„æ¥å£å¯¼å…¥
3. **é›†æˆMeterSphere** - å¯¼å‡ºæµ‹è¯•ç”¨ä¾‹åˆ°MeterSphere
4. **æ·»åŠ çŸ¥è¯†å›¾è°±** - æ›´æ™ºèƒ½çš„æ¥å£ä¾èµ–åˆ†æ
5. **å®ç°æ™ºèƒ½ç»´æŠ¤** - è‡ªåŠ¨æ£€æµ‹æ¥å£å˜æ›´

## ğŸ¯ æˆåŠŸæ ‡å¿—

å¦‚æœä½ çœ‹åˆ°ä»¥ä¸‹è¾“å‡ºï¼Œè¯´æ˜æµ‹è¯•æˆåŠŸï¼š

```
âœ… ç«¯åˆ°ç«¯æµ‹è¯•å®Œæˆï¼
   æˆåŠŸç‡: 100.00%
```

æ­å–œï¼ä½ å·²ç»æˆåŠŸè¿è¡Œäº†AIæ™ºèƒ½æ¥å£æµ‹è¯•å¹³å°ï¼ğŸ‰
